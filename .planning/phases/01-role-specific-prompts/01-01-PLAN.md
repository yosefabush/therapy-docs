---
phase: 01-role-specific-prompts
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/lib/prompts/index.ts
  - src/lib/prompts/psychologist.ts
  - src/lib/prompts/psychiatrist.ts
  - src/lib/prompts/social-worker.ts
  - src/lib/prompts/occupational-therapist.ts
  - src/lib/prompts/speech-therapist.ts
  - src/lib/prompts/physical-therapist.ts
  - src/lib/prompts/counselor.ts
  - src/lib/prompts/art-therapist.ts
  - src/lib/prompts/music-therapist.ts
  - src/lib/prompts/family-therapist.ts
autonomous: true

must_haves:
  truths:
    - "Each of 10 therapist roles has a dedicated prompt"
    - "Prompts accept SOAP notes and transcript as template variables"
    - "Prompts emphasize role-specific clinical focus areas"
    - "Prompt retrieval by role works correctly"
  artifacts:
    - path: "src/lib/prompts/index.ts"
      provides: "Prompt registry and getPromptForRole() function"
      exports: ["getPromptForRole", "SessionSummaryPrompt"]
    - path: "src/lib/prompts/psychologist.ts"
      provides: "Psychologist prompt with cognitive/behavioral focus"
      exports: ["psychologistPrompt"]
    - path: "src/lib/prompts/psychiatrist.ts"
      provides: "Psychiatrist prompt with medication/symptom focus"
      exports: ["psychiatristPrompt"]
    - path: "src/lib/prompts/social-worker.ts"
      provides: "Social worker prompt with systemic/resource focus"
      exports: ["socialWorkerPrompt"]
    - path: "src/lib/prompts/occupational-therapist.ts"
      provides: "OT prompt with functional progress focus"
      exports: ["occupationalTherapistPrompt"]
    - path: "src/lib/prompts/speech-therapist.ts"
      provides: "Speech therapist prompt with communication focus"
      exports: ["speechTherapistPrompt"]
    - path: "src/lib/prompts/physical-therapist.ts"
      provides: "PT prompt with motor/mobility focus"
      exports: ["physicalTherapistPrompt"]
    - path: "src/lib/prompts/counselor.ts"
      provides: "Counselor prompt with therapeutic relationship focus"
      exports: ["counselorPrompt"]
    - path: "src/lib/prompts/art-therapist.ts"
      provides: "Art therapist prompt with creative expression focus"
      exports: ["artTherapistPrompt"]
    - path: "src/lib/prompts/music-therapist.ts"
      provides: "Music therapist prompt with musical engagement focus"
      exports: ["musicTherapistPrompt"]
    - path: "src/lib/prompts/family-therapist.ts"
      provides: "Family therapist prompt with relationship dynamics focus"
      exports: ["familyTherapistPrompt"]
  key_links:
    - from: "src/lib/prompts/index.ts"
      to: "All role prompt files"
      via: "Named imports and prompt registry"
      pattern: "import.*from.*\\./(psychologist|psychiatrist|social-worker)"
---

<objective>
Create 10 role-specific AI prompts for session summary generation, one for each therapist type in the system.

Purpose: These prompts are the foundation for AI-powered session summaries. Each prompt must speak the professional language of its role - psychiatrists focus on medication and symptoms, OTs on functional progress, social workers on systemic factors, etc.

Output: A `src/lib/prompts/` directory containing 10 role-specific prompt files plus an index that provides `getPromptForRole()` lookup.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md

# Existing code to understand the domain
@src/types/index.ts - TherapistRole type, SessionNotes interface
@src/lib/templates.ts - Role-specific fields, interventions, assessment scales
@src/lib/ai-features.ts - Existing role dispatch pattern (will be updated in Plan 02)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create prompt type and registry structure</name>
  <files>src/lib/prompts/index.ts</files>
  <action>
Create `src/lib/prompts/` directory and `index.ts` with:

1. `SessionSummaryPrompt` interface:
```typescript
export interface SessionSummaryPrompt {
  role: TherapistRole;
  systemPrompt: string;      // Role context and instructions
  userPromptTemplate: string; // Template with {{soapNotes}} and {{transcript}} placeholders
  focusAreas: string[];      // Role-specific priorities for summary
  outputFormat: string;      // Expected structure of generated summary
}
```

2. Import all 10 role prompts (files created in Task 2)

3. `promptRegistry` map: Record<TherapistRole, SessionSummaryPrompt>

4. `getPromptForRole(role: TherapistRole): SessionSummaryPrompt` function that:
   - Looks up prompt in registry
   - Throws descriptive error if role not found (should never happen with type safety)

5. Export types and functions for use by ai-features.ts

Use template literal strings for prompts - they will contain multi-line instructions.
  </action>
  <verify>
TypeScript compiles: `npx tsc --noEmit src/lib/prompts/index.ts`
  </verify>
  <done>
index.ts exports SessionSummaryPrompt type and getPromptForRole() function; all 10 role imports present
  </done>
</task>

<task type="auto">
  <name>Task 2: Create 10 role-specific prompt files</name>
  <files>
src/lib/prompts/psychologist.ts
src/lib/prompts/psychiatrist.ts
src/lib/prompts/social-worker.ts
src/lib/prompts/occupational-therapist.ts
src/lib/prompts/speech-therapist.ts
src/lib/prompts/physical-therapist.ts
src/lib/prompts/counselor.ts
src/lib/prompts/art-therapist.ts
src/lib/prompts/music-therapist.ts
src/lib/prompts/family-therapist.ts
  </files>
  <action>
Create each prompt file exporting a `SessionSummaryPrompt` object. Each prompt must:

1. Have a `systemPrompt` that:
   - Establishes the AI as an expert in that clinical role
   - Defines the professional vocabulary and focus areas
   - Instructs to write clinically appropriate summaries
   - Specifies bilingual capability (Hebrew and English based on input language)

2. Have a `userPromptTemplate` with placeholders:
   - `{{soapNotes}}` - Will contain SOAP note fields (subjective, objective, assessment, plan, interventions, etc.)
   - `{{transcript}}` - Will contain session transcript (may be empty)
   - Instructions for handling missing transcript gracefully

3. Define `focusAreas` array specific to each role:

Role-specific focus areas (reference src/lib/templates.ts for domain accuracy):

**Psychologist**: Cognitive patterns, psychological assessments (PHQ-9, GAD-7, BDI-II), therapeutic techniques (CBT, DBT, ACT), behavioral observations, treatment formulation

**Psychiatrist**: Medication regimen, side effects, symptom severity, diagnostic considerations, mental status exam findings, medication adjustments, lab monitoring

**Social Worker**: Social determinants of health (housing, food security, employment), resource connections, case management, advocacy needs, care coordination, systemic barriers

**Occupational Therapist**: Functional performance (ADLs, IADLs), activity tolerance, performance skills, environmental factors, goal progress toward independence, home program adherence

**Speech Therapist**: Communication abilities, articulation/phonology, language comprehension/expression, fluency, voice quality, swallowing function, cognitive-communication

**Physical Therapist**: Motor function, mobility, balance, strength, range of motion, pain levels, functional transfers, gait analysis, exercise adherence

**Counselor**: Presenting concerns, coping strategies, therapeutic alliance, treatment progress, psychoeducation topics, homework completion, session themes

**Art Therapist**: Creative expression, artistic media used, symbolic content, emotional themes in artwork, creative process observations, client reflections on art

**Music Therapist**: Musical engagement, instrument/voice use, emotional responses to music, rhythm/structure, therapeutic music interventions, non-verbal expression

**Family Therapist**: Relationship dynamics, communication patterns, family system observations, boundary issues, conflict patterns, structural interventions, family homework

4. Define `outputFormat` string describing expected summary structure:
   - 2-3 paragraph clinical summary
   - Key points in bullet format
   - Professional tone appropriate to the role
  </action>
  <verify>
All 10 files compile: `npx tsc --noEmit src/lib/prompts/*.ts`
Each file exports a valid SessionSummaryPrompt with all required fields
  </verify>
  <done>
10 prompt files exist, each with systemPrompt, userPromptTemplate with {{soapNotes}} and {{transcript}} placeholders, focusAreas array, and outputFormat
  </done>
</task>

<task type="auto">
  <name>Task 3: Verify prompt registry completeness</name>
  <files>src/lib/prompts/index.ts</files>
  <action>
Create a simple verification that all 10 TherapistRole values have corresponding prompts:

1. Add a type-level check in index.ts that ensures promptRegistry covers all TherapistRole values:
```typescript
// Type-level completeness check - will error if a role is missing
const _exhaustiveCheck: Record<TherapistRole, SessionSummaryPrompt> = promptRegistry;
```

2. Run TypeScript compilation to verify type completeness

3. Manually verify each role's prompt is imported and added to registry:
   - psychologist
   - psychiatrist
   - social_worker
   - occupational_therapist
   - speech_therapist
   - physical_therapist
   - counselor
   - art_therapist
   - music_therapist
   - family_therapist
  </action>
  <verify>
`npx tsc --noEmit` passes with no errors about missing registry entries
`getPromptForRole('psychologist')` returns valid prompt (manual test or add simple console.log test)
  </verify>
  <done>
TypeScript confirms all 10 roles have prompts; getPromptForRole works for any TherapistRole value
  </done>
</task>

</tasks>

<verification>
1. `npm run lint` passes
2. `npx tsc --noEmit` passes
3. 11 files exist in src/lib/prompts/ (index + 10 roles)
4. Each prompt file exports SessionSummaryPrompt with all required fields
5. getPromptForRole() returns correct prompt for each role
</verification>

<success_criteria>
- 10 distinct prompt files created, one per TherapistRole
- Each prompt has role-appropriate focus areas and clinical vocabulary
- Prompts accept {{soapNotes}} and {{transcript}} template variables
- Registry provides type-safe lookup by role
- TypeScript compilation passes
</success_criteria>

<output>
After completion, create `.planning/phases/01-role-specific-prompts/01-01-SUMMARY.md`
</output>
